\PassOptionsToPackage{unicode=true}{hyperref} % options for packages loaded elsewhere
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provides euro and other symbols
\else % if luatex or xelatex
  \usepackage{unicode-math}
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\usepackage{hyperref}
\hypersetup{
            pdftitle={Classification},
            pdfauthor={Giorgos Tsalidis},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{Classification}
\author{Giorgos Tsalidis}
\date{1/31/2020}

\begin{document}
\maketitle

\hypertarget{classification-with-decision-trees}{%
\subsection{Classification with Decision
trees}\label{classification-with-decision-trees}}

A Decision Tree is a Machine Learning algorithm that is used mainly for
classification problems. It can be applied to categorical and continuous
data. The main concept of the algorithm is simple; the data are split
consecutively according to certain splitting criteria.

Decision trees are computationally efficient when training and quite
fast for classifying new instances. Furthermore, they are
comprehensional when they are not too large, therefore they are
frequently used for data exploration. A common pitfall is that they are
sensitive to overfitting, which can be confronted by pruning or by
adding further criteria when building the tree.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(rpart)}
\KeywordTok{library}\NormalTok{(rpart.plot)}
\NormalTok{weather=}\KeywordTok{read.csv}\NormalTok{(}\StringTok{"../data/weather.txt"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{including-plots}{%
\subsection{Including Plots}\label{including-plots}}

You can also embed plots, for example:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#To see the split for the variable Outlook, execute the following command}
\NormalTok{model<-}\KeywordTok{rpart}\NormalTok{(Play}\OperatorTok{~}\NormalTok{Outlook, }\DataTypeTok{method=}\StringTok{"class"}\NormalTok{, }\DataTypeTok{data=}\NormalTok{weather, }\DataTypeTok{minsplit=}\DecValTok{1}\NormalTok{)}
\KeywordTok{rpart.plot}\NormalTok{(model, }\DataTypeTok{extra =} \DecValTok{104}\NormalTok{, }\DataTypeTok{nn =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{classification_files/figure-latex/unnamed-chunk-2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{absfreq=}\KeywordTok{table}\NormalTok{(weather[,}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{4}\NormalTok{)])}
\NormalTok{freq=}\KeywordTok{prop.table}\NormalTok{(absfreq,}\DecValTok{1}\NormalTok{)}
\NormalTok{freqSum=}\KeywordTok{rowSums}\NormalTok{(}\KeywordTok{prop.table}\NormalTok{(absfreq))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#calculate the Gini index for Sunny and Rainy}
\NormalTok{GINI_Sunny=}\DecValTok{1}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"No"}\NormalTok{]}\OperatorTok{^}\DecValTok{2}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{]}\OperatorTok{^}\DecValTok{2}
\NormalTok{GINI_Rainy=}\DecValTok{1}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"No"}\NormalTok{]}\OperatorTok{^}\DecValTok{2}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{]}\OperatorTok{^}\DecValTok{2}

\CommentTok{#The total Gini for Outlook is computed by}
\end{Highlighting}
\end{Shaded}

Similarly, the GINI for Temperature and Humidity is GIN I T emp. = 0.367
and GIN I T emp. = 0.394 , respectively. Hence, answering to question
(a), the optimal first split using the Gini index is on Outlook.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{GINI_Outlook=freqSum[}\StringTok{"Sunny"}\NormalTok{]}\OperatorTok{*}\NormalTok{GINI_Sunny}\OperatorTok{+}\NormalTok{freqSum[}\StringTok{"Rainy"}\NormalTok{]}\OperatorTok{*}\NormalTok{GINI_Rainy}
\end{Highlighting}
\end{Shaded}

Initially, we compute the total entropy of the dataset:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{freq =}\StringTok{ }\KeywordTok{prop.table}\NormalTok{(}\KeywordTok{table}\NormalTok{(weather[, }\KeywordTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{)]))}
\NormalTok{Entropy_All =}\StringTok{ }\OperatorTok{-}\StringTok{ }\NormalTok{freq[}\StringTok{"No"}\NormalTok{] }\OperatorTok{*}\StringTok{ }\KeywordTok{log}\NormalTok{(freq[}\StringTok{"No"}\NormalTok{]) }\OperatorTok{-}\StringTok{ }\NormalTok{freq[}\StringTok{"Yes"}\NormalTok{] }\OperatorTok{*}\StringTok{ }\KeywordTok{log}\NormalTok{(freq[}\StringTok{"Yes"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

Then, for Outlook, we build the following frequency arrays:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{absfreq =}\StringTok{ }\KeywordTok{table}\NormalTok{(weather[, }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{)])}
\NormalTok{freq =}\StringTok{ }\KeywordTok{prop.table}\NormalTok{(absfreq, }\DecValTok{1}\NormalTok{)}
\NormalTok{freqSum =}\StringTok{ }\KeywordTok{rowSums}\NormalTok{(}\KeywordTok{prop.table}\NormalTok{(absfreq))}
\end{Highlighting}
\end{Shaded}

We calculate the entropy for Sunny and Rainy:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#calculate the entropy for Sunny and Rainy}
\NormalTok{Entropy_Sunny=}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"No"}\NormalTok{]}\OperatorTok{*}\KeywordTok{log}\NormalTok{(freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"No"}\NormalTok{])}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{]}\OperatorTok{*}\KeywordTok{log}\NormalTok{(freq[}\StringTok{"Sunny"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{])}
\NormalTok{Entropy_Rainy=}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"No"}\NormalTok{]}\OperatorTok{*}\KeywordTok{log}\NormalTok{(freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"No"}\NormalTok{])}\OperatorTok{-}\NormalTok{freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{]}\OperatorTok{*}\KeywordTok{log}\NormalTok{(freq[}\StringTok{"Rainy"}\NormalTok{,}\StringTok{"Yes"}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

The total information gain for Outlook is computed by:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#the tolat information for Outlook }
\NormalTok{GAIN_Outlook=Entropy_All}\OperatorTok{-}\NormalTok{freqSum[}\StringTok{"Sunny"}\NormalTok{]}\OperatorTok{*}\NormalTok{Entropy_Sunny}\OperatorTok{-}\NormalTok{freqSum[}\StringTok{"Rainy"}\NormalTok{]}\OperatorTok{*}\NormalTok{Entropy_Rainy}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Building the Decision Tree using rpart}
\NormalTok{model<-}\KeywordTok{rpart}\NormalTok{(Play}\OperatorTok{~}\NormalTok{Outlook}\OperatorTok{+}\NormalTok{Temperature}\OperatorTok{+}\NormalTok{Humidity,}
             \DataTypeTok{method=}\StringTok{"class"}\NormalTok{,}
             \DataTypeTok{data=}\NormalTok{weather,}
             \DataTypeTok{minsplit=}\DecValTok{1}\NormalTok{,}
             \DataTypeTok{minbucket=}\DecValTok{1}\NormalTok{,}
             \DataTypeTok{cp=}\OperatorTok{-}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rpart.plot}\NormalTok{(model, }\DataTypeTok{extra =} \DecValTok{104}\NormalTok{, }\DataTypeTok{nn =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{classification_files/figure-latex/unnamed-chunk-11-1.pdf}

\hypertarget{application-with-pruning-and-evaluation-metrics}{%
\subsection{Application with Pruning and Evaluation
Metrics}\label{application-with-pruning-and-evaluation-metrics}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris2 =}\StringTok{ }\NormalTok{iris[, }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{)]}
\NormalTok{iris2}\OperatorTok{$}\NormalTok{Species[}\KeywordTok{c}\NormalTok{(}\DecValTok{101}\OperatorTok{:}\DecValTok{150}\NormalTok{)] =}\StringTok{ }\NormalTok{iris2}\OperatorTok{$}\NormalTok{Species[}\KeywordTok{c}\NormalTok{(}\DecValTok{21}\OperatorTok{:}\DecValTok{70}\NormalTok{)]}
\NormalTok{iris2}\OperatorTok{$}\NormalTok{Species =}\StringTok{ }\KeywordTok{factor}\NormalTok{(iris2}\OperatorTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

After that, we split the dataset into training and testing data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{trainingdata =}\StringTok{ }\NormalTok{iris2[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{40}\NormalTok{, }\DecValTok{51}\OperatorTok{:}\DecValTok{90}\NormalTok{, }\DecValTok{101}\OperatorTok{:}\DecValTok{140}\NormalTok{),]}
\NormalTok{testdata =}\StringTok{ }\NormalTok{iris2[}\KeywordTok{c}\NormalTok{(}\DecValTok{41}\OperatorTok{:}\DecValTok{50}\NormalTok{, }\DecValTok{91}\OperatorTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{141}\OperatorTok{:}\DecValTok{150}\NormalTok{),]}
\end{Highlighting}
\end{Shaded}

train the decision tree and plot it using the following commands

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Build a decision tree using the training data (the minsplit parameter of rpart should be set to20, which is the default)}
\NormalTok{model<-}\KeywordTok{rpart}\NormalTok{(Species}\OperatorTok{~}\NormalTok{., }\CommentTok{#The . in the formula stands for all the remaining variables in the data frame trainingdata}
             \DataTypeTok{method=}\StringTok{"class"}\NormalTok{,}
             \DataTypeTok{data=}\NormalTok{trainingdata,}
             \DataTypeTok{minsplit=}\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Visualise model

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{rpart.plot}\NormalTok{(model, }\DataTypeTok{extra =} \DecValTok{104}\NormalTok{, }\DataTypeTok{nn =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{classification_files/figure-latex/unnamed-chunk-15-1.pdf}

Execute on test set

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{xtest =}\StringTok{ }\NormalTok{testdata[,}\DecValTok{1}\OperatorTok{:}\DecValTok{2}\NormalTok{]}
\NormalTok{ytest =}\StringTok{ }\NormalTok{testdata[,}\DecValTok{3}\NormalTok{]}
\NormalTok{pred =}\StringTok{ }\KeywordTok{predict}\NormalTok{(model, xtest, }\DataTypeTok{type=}\StringTok{"class"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{evaluation-metrics}{%
\subsection{Evaluation Metrics}\label{evaluation-metrics}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(MLmetrics)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'MLmetrics'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:base':
## 
##     Recall
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cm =}\StringTok{ }\KeywordTok{ConfusionMatrix}\NormalTok{(pred, ytest)}
\NormalTok{accuracy =}\StringTok{ }\KeywordTok{Accuracy}\NormalTok{(pred, ytest)}
\NormalTok{precision =}\StringTok{ }\KeywordTok{Precision}\NormalTok{(ytest, pred, }\StringTok{'versicolor'}\NormalTok{)}
\NormalTok{recall =}\StringTok{ }\KeywordTok{Recall}\NormalTok{(ytest, pred, }\StringTok{'versicolor'}\NormalTok{)}
\NormalTok{f1 =}\StringTok{ }\KeywordTok{F1_Score}\NormalTok{(ytest, pred, }\StringTok{'versicolor'}\NormalTok{)}
\KeywordTok{data.frame}\NormalTok{(precision, recall, f1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   precision recall        f1
## 1         1    0.9 0.9473684
\end{verbatim}

\hypertarget{classification-with-naive-bayes}{%
\subsection{Classification with Naive
Bayes}\label{classification-with-naive-bayes}}

\end{document}
